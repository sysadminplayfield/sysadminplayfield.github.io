<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2021-08-04T16:59:46-05:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">SysAdmin Playfield</title><subtitle>Short Linux tutorials for RHEL/CentOS</subtitle><entry><title type="html">Jekyll and gh-pages</title><link href="http://localhost:4000/linux/2021/08/04/linux-jekyll-gh-pages.html" rel="alternate" type="text/html" title="Jekyll and gh-pages" /><published>2021-08-04T00:00:00-05:00</published><updated>2021-08-04T00:00:00-05:00</updated><id>http://localhost:4000/linux/2021/08/04/linux-jekyll-gh-pages</id><content type="html" xml:base="http://localhost:4000/linux/2021/08/04/linux-jekyll-gh-pages.html">&lt;p&gt;GitHub allows you to use your repository as a storage for a personal static website through its gh-pages.&lt;/p&gt;

&lt;p&gt;Jekyll, a Ruby based static website generator, is supported and is a great tool to give a dynamic taste to your static site.&lt;/p&gt;

&lt;p&gt;First, let’s install Jekyll locally.&lt;/p&gt;

&lt;h2 id=&quot;jekyll&quot;&gt;Jekyll&lt;/h2&gt;

&lt;h3 id=&quot;install-ruby&quot;&gt;Install ruby:&lt;/h3&gt;

&lt;p&gt;There are several ways to install Ruby. Here are 2 of them:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Install Ruby from your distribution package manager, following the official documentation: 
&lt;a href=&quot;https://www.ruby-lang.org/en/documentation/installation/&quot;&gt;https://www.ruby-lang.org/en/documentation/installation/&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Or install RVM (Ruby Version Manager) so you can have several different versions of ruby on your system:
&lt;a href=&quot;https://rvm.io/&quot;&gt;https://rvm.io/&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;install-jekyll-and-bundler&quot;&gt;Install Jekyll and bundler&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ gem install jekyll bundler
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;initialize-your-jekyll-website&quot;&gt;Initialize your Jekyll website&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ mkdir mywebsite
$ cd mywebsite
$ bundle install
$ bundle exec jekyll s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;browse-your-local-website&quot;&gt;Browse your local website&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;http://127.0.0.1:4000&quot;&gt;http://127.0.0.1:4000&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;create-a-new-postpagearticle&quot;&gt;Create a new post/page/article&lt;/h4&gt;

&lt;p&gt;Jekyll generates your pages written in markdown syntax under mywebsite/_posts.&lt;/p&gt;

&lt;p&gt;Let’s create a new post:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd mywebsite/_posts

vi $(date +&quot;%F&quot;)-my-first-article.md

	---
	layout: post
	title:  &quot;My first post&quot;
	date:	&quot;YYYY-MM-DD&quot;		### REPLACE YYY-MM-DD BY THE CURRENT DATE
	categories: 

	---
	## Congratulations
	
	You have written your first article!

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or, the fast way with copy/paste:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cd mywebsite/_posts &amp;amp;&amp;amp; cat &amp;lt;&amp;lt;EOF &amp;gt; $(date +&quot;%F&quot;)-my-first-article.md
---
layout: post
title:  &quot;My first post&quot;
date:	&quot;$(date +&quot;%F&quot;)&quot;
categories: 

---
# Congratulations!

You have written your first article!
EOF
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;git&quot;&gt;Git&lt;/h2&gt;

&lt;h3 id=&quot;install-git&quot;&gt;Install git&lt;/h3&gt;
&lt;p&gt;For RHEL/CentOS/Fedora:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install git
or
# dnf install git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For Debian based distributions:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# apt install git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;github-configuration&quot;&gt;Github configuration&lt;/h3&gt;

&lt;p&gt;Create a github account.&lt;/p&gt;

&lt;p&gt;Create a new repository.&lt;/p&gt;

&lt;p&gt;Create an additional branch: gh-pages.&lt;/p&gt;

&lt;p&gt;Optional: Go to your account settings and set up authentication keys (ssh) so, later, git will not ask you for a password every time you push new commits to the master branch.&lt;/p&gt;

&lt;p&gt;Initialize your repository:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd mywebsite/_site
$ git init
$ git checkout master
$ git add .
$ git commit -m &quot;first commit&quot;
$ git push origin master
$ git checkout gh-pages
$ git rebase master
$ git push origin gh-pages
$ git checkout master
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To ease the procedure, you can set an alias in mywebsite/_site/.git/config&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[alias]
    sync-ghpages = !git checkout gh-pages &amp;amp;&amp;amp; git rebase master &amp;amp;&amp;amp; git push origin gh-pages &amp;amp;&amp;amp; git checkout master
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, you only have to commit and push to the master branch, then use the alias &lt;em&gt;sync-ghpages&lt;/em&gt; to synchronize the gh-pages with the master branch.&lt;/p&gt;</content><author><name></name></author><summary type="html">GitHub allows you to use your repository as a storage for a personal static website through its gh-pages.</summary></entry><entry><title type="html">RHCE - Part1 - Link aggregation: Bonding, teaming</title><link href="http://localhost:4000/rhce/centos7/2020/02/22/rhce-01-bonding-teaming.html" rel="alternate" type="text/html" title="RHCE - Part1 - Link aggregation: Bonding, teaming" /><published>2020-02-22T11:45:00-06:00</published><updated>2020-02-22T11:45:00-06:00</updated><id>http://localhost:4000/rhce/centos7/2020/02/22/rhce-01-bonding-teaming</id><content type="html" xml:base="http://localhost:4000/rhce/centos7/2020/02/22/rhce-01-bonding-teaming.html">&lt;p&gt;&lt;strong&gt;Display&lt;/strong&gt; existing &lt;strong&gt;connections&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli c s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Delete&lt;/strong&gt; existing &lt;strong&gt;connections&lt;/strong&gt; automatically created by NetworkManager:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli con del &quot;Wired connection 1&quot;
# nmcli con del &quot;Wired connection 2&quot;
# nmcli con del eth0
# nmcli con del eth1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;BONDING&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; the &lt;strong&gt;bonding&lt;/strong&gt; connection (here, &lt;strong&gt;mode 1&lt;/strong&gt; is &lt;strong&gt;active-backup&lt;/strong&gt;):&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli con add type bond ifname bond0 con-name bond0 mode 1
or
# nmcli con add type bond ifname bond0 con-name bond0 mode active-backup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; the 2 &lt;strong&gt;slave connections&lt;/strong&gt;, based on the interface name:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli con add type bond-slave ifname eth0 con-name eth0 master bond0
# nmcli con add type bond-slave ifname eth1 con-name eth1 master bond0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Configure bond0&lt;/strong&gt; connection:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli con mod bond0 ipv4.addresses &quot;192.168.2.10/24 192.168.2.1&quot; \
			ipv4.dns 192.168.2.200 ipv4.method manual \
			connection.autoconnect yes
# nmcli con up bond0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When bond0 is started, both slave interfaces are started too.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;TEAMING&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; the &lt;strong&gt;teaming&lt;/strong&gt; connection:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli con add type team ifname team0 con-name team0 config '{&quot;runner&quot;: {&quot;name&quot;: &quot;activebackup&quot;}}'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; the &lt;strong&gt;slave connections&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli con add type team-slave ifname eth0 con-name eth0 master team0
# nmcli con add type team-slave ifname eth1 con-name eth1 master team0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Edit team0&lt;/strong&gt; connection:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli con mod team0 ipv4.addresses &quot;192.168.2.20/24 192.168.2.1&quot; ipv4.dns 192.168.2.200 ipv4.method manual connection.autoconnect yes
# nmcli con up eth0
# nmcli con up eth1
# nmcli con up team0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Before starting team0, make sure to start the slave interfaces.&lt;/p&gt;</content><author><name></name></author><summary type="html">Display existing connections:</summary></entry><entry><title type="html">RHCE - Part2 - Directory services: client connection using Kerberos</title><link href="http://localhost:4000/rhce/centos7/2020/02/22/rhce-02-directory-client-kerberos.html" rel="alternate" type="text/html" title="RHCE - Part2 - Directory services: client connection using Kerberos" /><published>2020-02-22T11:30:00-06:00</published><updated>2020-02-22T11:30:00-06:00</updated><id>http://localhost:4000/rhce/centos7/2020/02/22/rhce-02-directory-client-kerberos</id><content type="html" xml:base="http://localhost:4000/rhce/centos7/2020/02/22/rhce-02-directory-client-kerberos.html">&lt;p&gt;kdc = ldap.example.local&lt;br /&gt;
realm = EXAMPLE.LOCAL&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;LDAP KERBEROS CLIENT&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Edit authconfig&lt;/strong&gt; configuration detailed in the RHCSA section &lt;a href=&quot;https://sysadminplayfield.github.io/rhcsa/centos7/2020/02/20/rhcsa-17-sssd.html&quot;&gt;https://sysadminplayfield.github.io/rhcsa/centos7/2020/02/20/rhcsa-17-sssd.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Enable Kerberos authenrication method&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# authconfig --enablekrb5 --krb5kdc=ldap.example.local --krb5realm=EXAMPLE.LOCAL --update
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">kdc = ldap.example.local realm = EXAMPLE.LOCAL</summary></entry><entry><title type="html">RHCE - Part3 - iSCSI: Target and Initiator</title><link href="http://localhost:4000/rhce/centos7/2020/02/22/rhce-04-iscsi.html" rel="alternate" type="text/html" title="RHCE - Part3 - iSCSI: Target and Initiator" /><published>2020-02-22T11:15:00-06:00</published><updated>2020-02-22T11:15:00-06:00</updated><id>http://localhost:4000/rhce/centos7/2020/02/22/rhce-04-iscsi</id><content type="html" xml:base="http://localhost:4000/rhce/centos7/2020/02/22/rhce-04-iscsi.html">&lt;p&gt;Target (server) = srv.example.local&lt;br /&gt;
Initiator (client) = client.example.local&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;TARGET&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Install targetcli&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install -y targetcli
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Enable target&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl enable target
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enter the CLI to &lt;strong&gt;configure&lt;/strong&gt; the &lt;strong&gt;target&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# targetcli
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; the &lt;strong&gt;backstores&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/&amp;gt; backstores/fileio create file1 /srv/lunfile 100M sparse=true write_back=false
/&amp;gt; backstores/block create block1 /dev/vg/lv_iscsi write_back=false
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create IQN&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/&amp;gt; iscsi/ create iqn.2020-02.local.example:srv
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create portal&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/&amp;gt; iscsi/iqn.2020-02.local.example:srv/tpg1/portals create
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; &lt;strong&gt;ACL&lt;/strong&gt; (client/&lt;strong&gt;initiator&lt;/strong&gt; configuration):&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/&amp;gt; iscsi/iqn.2020-02.local.example:srv/tpg1/acls create iqn.2020-02.local.example:client
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create LUNs&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/&amp;gt; iscsi/iqn.2020-02.local.example:srv/tpg1/luns create /backstores/fileio/file1
/&amp;gt; iscsi/iqn.2020-02.local.example:srv/tpg1/luns create /backstores/block/block1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Optional&lt;/strong&gt;: Set &lt;strong&gt;CHAP&lt;/strong&gt; connection and set &lt;strong&gt;username&lt;/strong&gt; and &lt;strong&gt;password&lt;/strong&gt; for the &lt;strong&gt;initiator&lt;/strong&gt; to log onto the target:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/&amp;gt; iscsi/iqn.2020-02.local.example:srv/tpg1/acls/iqn.2020-02.local.example:client set auth userid=user password=pass
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Check target configuration&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/&amp;gt; ls
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Save configuration&lt;/strong&gt; and exit the CLI:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/&amp;gt; saveconfig
/&amp;gt; exit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Open&lt;/strong&gt; port &lt;strong&gt;3260/tcp&lt;/strong&gt; in firewall:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-port=3260/tcp
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;INITIATOR&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Install iscsi-initiator-utils&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install -y iscsi-initiator-utils
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Configure initiator name&lt;/strong&gt; in &lt;strong&gt;/etc/iscsi/initiatorname.iscsi&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;vi /etc/iscsi/initiatorname.iscsi&lt;/b&gt;
InitiatorName=iqn.2020-02.local.example:client
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Optional&lt;/strong&gt;: configure &lt;strong&gt;CHAP&lt;/strong&gt; settings in &lt;strong&gt;/etc/iscsi/iscsid.conf&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;vi /etc/iscsi/iscsid.conf&lt;/b&gt;
[...]
node.session.auth.authmethod = CHAP
[...]
node.session.auth.username = user
node.session.auth.password = pass
[...]
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Enable&lt;/strong&gt; and &lt;strong&gt;start&lt;/strong&gt; &lt;strong&gt;iscsi&lt;/strong&gt; and &lt;strong&gt;iscsid&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl enable iscsi iscsid
# systemctl start iscsi iscsid
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Start target discovery&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# iscsiadm -m discovery -t st -p srv.example.local:3260
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Login&lt;/strong&gt; and connect to the target:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# iscsiadm -m node -T iqn.2020-02.local.example:srv -p srv.example.local:3260 --login
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Check iscsi&lt;/strong&gt; LUNs provided by the target:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# lsblk -S | grep LIO
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Last step, you can :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;use the mapped &lt;strong&gt;LUNs&lt;/strong&gt; as &lt;strong&gt;LVMs&lt;/strong&gt; (create a VG and LVs)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;format&lt;/strong&gt; these drives/LVs to the required &lt;strong&gt;filesystem&lt;/strong&gt; (xfs, ext4, etc. …)&lt;/li&gt;
  &lt;li&gt;use &lt;strong&gt;blkid&lt;/strong&gt; to retrieve UUIDs, logical names or aliases&lt;/li&gt;
  &lt;li&gt;append the information to &lt;strong&gt;/etc/fstab&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;If&lt;/strong&gt; the &lt;strong&gt;discovery failed&lt;/strong&gt;, &lt;strong&gt;delete files under /var/lib/iscsi/nodes/&lt;/strong&gt;* and &lt;strong&gt;retry&lt;/strong&gt; with &lt;strong&gt;correct&lt;/strong&gt; discovery &lt;strong&gt;parameters&lt;/strong&gt;.&lt;/p&gt;</content><author><name></name></author><summary type="html">Target (server) = srv.example.local Initiator (client) = client.example.local</summary></entry><entry><title type="html">RHCE - Part4 - nfs Kerberos</title><link href="http://localhost:4000/rhce/centos7/2020/02/22/rhce-03-nfs-kerberos.html" rel="alternate" type="text/html" title="RHCE - Part4 - nfs Kerberos" /><published>2020-02-22T11:00:00-06:00</published><updated>2020-02-22T11:00:00-06:00</updated><id>http://localhost:4000/rhce/centos7/2020/02/22/rhce-03-nfs-kerberos</id><content type="html" xml:base="http://localhost:4000/rhce/centos7/2020/02/22/rhce-03-nfs-kerberos.html">&lt;p&gt;Make sure to review RHCSA topic on nfs &lt;a href=&quot;https://sysadminplayfield.github.io/rhcsa/centos7/2020/02/20/rhcsa-18-nfs-samba.html&quot;&gt;https://sysadminplayfield.github.io/rhcsa/centos7/2020/02/20/rhcsa-18-nfs-samba.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;KDC: kdc.example.local&lt;br /&gt;
Server: srv.example.local&lt;br /&gt;
Client: client.example.local&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;NFS SERVER CONFIGURATION&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Create directory&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir /srv/nfskerberos
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Set SELinux context&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# semanage fcontext -at nfs_t &quot;/srv/nfskerberos(/.*)?&quot;
# restorecon -v /srv/nfskerberos
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Edit /etc/exports&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;vi /etc/exports&lt;/b&gt;
/srv/nfskerberos client.example.local(sec=krb5p,rw,sync)
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Retrieve keytab file from the KDC&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# wget -O /etc/krb5.keytab ftp://kdc.example.local/pub/srv.keytab
or, if ipa-client is installed
# ipa-getkeytab -s kdc.example.local -p nfs/srv.example.local -k /etc/krb5.keytab
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Optional&lt;/strong&gt;: &lt;strong&gt;Enable&lt;/strong&gt; NFS &lt;strong&gt;version 4.2&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;vi /etc/sysconfig/nfs&lt;/b&gt;
[...]
RPCNFSDARGS=&quot;&lt;b&gt;-V 4.2&lt;/b&gt;&quot;
[...]
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Enable&lt;/strong&gt; and &lt;strong&gt;start&lt;/strong&gt; &lt;strong&gt;nfs-server&lt;/strong&gt; and &lt;strong&gt;nfs-secure-server&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl enable nfs-server nfs-secure-server
# systemctl start nfs-server nfs-secure-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Allow nfs&lt;/strong&gt; in &lt;strong&gt;firewall&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-service=nfs
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Optional&lt;/strong&gt;: In some cases, &lt;strong&gt;mountd&lt;/strong&gt; and &lt;strong&gt;rpc-bind&lt;/strong&gt; are required in &lt;strong&gt;firewalld&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;The server is NFS3&lt;/li&gt;
  &lt;li&gt;The server is NFS4 and allows the remote clients to discover exported shares&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-service={mountd,rpc-bind}
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;NFS CLIENT CONFIGURATION&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Install nfs-utils&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install -y nfs-utils
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create mountpoint&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir /mnt/nfs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Retrieve keytab file from the KDC&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# wget -O /etc/krb5.keytab ftp://kdc.example.local/pub/client.keytab
or, if ipa-client is installed
# ipa-getkeytab -s kdc.example.local -p nfs/client.example.local -k /etc/krb5.keytab
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Enable&lt;/strong&gt; and &lt;strong&gt;start nfs-secure&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl enable nfs-secure
# systemctl start nfs-secure
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Temporarily mount&lt;/strong&gt; the nfs share:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;For nfs3
# mount -v -t nfs -o vers=3,sec=krb5p,rw,sync srv.example.local:/srv/nfskerberos /mnt/nfs

For nfs4
# mount -v -t nfs4 -o sec=krb5p,rw,sync srv.example.local:/srv/nfskerberos /mnt/nfs

For nfs4.2
# mount -v -t nfs4 -o sec=krb5p,rw,sync srv.example.local:/srv/nfskerberos /mnt/nfs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Permanently mount&lt;/strong&gt; the nfs share by editing &lt;strong&gt;/etc/fstab&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;vi /etc/fstab&lt;/b&gt;
[...]
#For nfs3
srv.example.local:/srv/nfskerberos	/mnt/nfs	nfs		vers=3,sec=krb5p,rw,sync	0 0

#For nfs4
srv.example.local:/srv/nfskerberos	/mnt/nfs	nfs		vers=4,sec=krb5p,rw,sync	0 0

#For nfs4.2
srv.example.local:/srv/nfskerberos	/mnt/nfs	nfs		vers=4.2,sec=krb5p,rw,sync	0 0
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Mount from /etc/fstab&lt;/strong&gt; entries:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mount -av
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">Make sure to review RHCSA topic on nfs https://sysadminplayfield.github.io/rhcsa/centos7/2020/02/20/rhcsa-18-nfs-samba.html</summary></entry><entry><title type="html">RHCE - Part5 - Postfix</title><link href="http://localhost:4000/rhce/centos7/2020/02/22/rhce-05-postfix.html" rel="alternate" type="text/html" title="RHCE - Part5 - Postfix" /><published>2020-02-22T10:45:00-06:00</published><updated>2020-02-22T10:45:00-06:00</updated><id>http://localhost:4000/rhce/centos7/2020/02/22/rhce-05-postfix</id><content type="html" xml:base="http://localhost:4000/rhce/centos7/2020/02/22/rhce-05-postfix.html">&lt;p&gt;&lt;strong&gt;NULL CLIENT&lt;/strong&gt; (relays mails to a central server)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Configure postfix&lt;/strong&gt; by editing &lt;strong&gt;/etc/postfix/main.cf&lt;/strong&gt;, &lt;strong&gt;or&lt;/strong&gt; send configuration from the terminal using &lt;strong&gt;postconf&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# postconf -e 'myhostname=srv.example.local'
# postconf -e 'mydomain=example.local'
# postconf -e 'myorigin=$mydomain'
# postconf -e 'inet_interfaces=loopback-only'
# postconf -e 'mydestination='
# postconf -e 'relayhost=[centralmail.example.local]'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Check&lt;/strong&gt; postfix &lt;strong&gt;configuration&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# postfix check
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Restart postfix&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart postfix
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CENTRAL MAIL SERVER&lt;/strong&gt; (gateway)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Configure postfix&lt;/strong&gt; by editing &lt;strong&gt;/etc/postfix/main.cf&lt;/strong&gt;, &lt;strong&gt;or&lt;/strong&gt; send configuration from the terminal using &lt;strong&gt;postconf&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# postconf -e 'myhostname=centralmail.example.local'
# postconf -e 'mydomain=example.local'
# postconf -e 'myorigin=$mydomain'
# postconf -e 'inet_interfaces=all'
# postconf -e 'mydestination=$myhostname, localhost.$mydomain, localhost, $mydomain'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Check&lt;/strong&gt; postfix &lt;strong&gt;configuration&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# postfix check
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Restart postfix&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart postfix
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Allow smtp in firewalld:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-service=smtp
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;TESTS&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Install mailx&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install -y mailx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Send&lt;/strong&gt; a &lt;strong&gt;mail&lt;/strong&gt; &lt;strong&gt;to&lt;/strong&gt; the &lt;strong&gt;root&lt;/strong&gt; user:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# echo test | mailx -s test root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Monitor&lt;/strong&gt; with &lt;strong&gt;journalctl&lt;/strong&gt; (if the mail is deleted, it has been sent):&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# journalctl -xlf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Check&lt;/strong&gt; the &lt;strong&gt;mail queue&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mailq
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Resend&lt;/strong&gt; a mail &lt;strong&gt;stuck&lt;/strong&gt; in the queue:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# postsuper -r ABCDEFGHI
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Delete&lt;/strong&gt; a mail &lt;strong&gt;stuck&lt;/strong&gt; in the queue:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# postsuper -d ABCDEFGHI
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">NULL CLIENT (relays mails to a central server)</summary></entry><entry><title type="html">RHCE - Part6 - mariadb</title><link href="http://localhost:4000/rhce/centos7/2020/02/22/rhce-06-mariadb.html" rel="alternate" type="text/html" title="RHCE - Part6 - mariadb" /><published>2020-02-22T10:30:00-06:00</published><updated>2020-02-22T10:30:00-06:00</updated><id>http://localhost:4000/rhce/centos7/2020/02/22/rhce-06-mariadb</id><content type="html" xml:base="http://localhost:4000/rhce/centos7/2020/02/22/rhce-06-mariadb.html">&lt;p&gt;server = srv.example.local&lt;br /&gt;
client = 192.168.2.20/24&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;MARIADB SERVER&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Install mariadb&lt;/strong&gt; and &lt;strong&gt;mariadb-server&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install -y mariadb mariadb-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Enable&lt;/strong&gt; and &lt;strong&gt;start mariadb&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl enable mariadb
# systemctl start mariadb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Run mysql_secure_installation&lt;/strong&gt; to set the root password, remove anonymous users and test database:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;mysql_secure_installation&lt;/b&gt;
Enter current password for root (enter for none): &lt;b&gt;enter&lt;/b&gt;
Set root password? [Y/n] &lt;b&gt;enter&lt;/b&gt;
New password: &lt;b&gt;password1&lt;/b&gt;
Re-enter new password: &lt;b&gt;password1&lt;/b&gt;
Remove anonymous users? [Y/n] &lt;b&gt;enter&lt;/b&gt;
Disallow root login remotely? [Y/n] &lt;b&gt;enter&lt;/b&gt;
Remove test database and access to it? [Y/n] &lt;b&gt;enter&lt;/b&gt;
Reload privilege tables now? [Y/n] &lt;b&gt;enter&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Login&lt;/strong&gt; as &lt;strong&gt;root&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mysql -uroot -p
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Display databases&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
MariaDB[(none)]&amp;gt; &lt;b&gt;show databases;&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;Create a database, a table and insert data:&lt;/p&gt;

&lt;pre&gt;
MariaDB[(none)]&amp;gt; &lt;b&gt;create database db1;&lt;/b&gt;
MariaDB[(none)]&amp;gt; &lt;b&gt;use db1;&lt;/b&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;create table table1(id INT(10) unsigned, name VARCHAR(20), age INT(10));&lt;/b&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;insert into table1(id,name,age) values (1,&quot;person1&quot;,25);&lt;/b&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;insert into table1(id,name,age) values (2,&quot;person2&quot;,55);&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Display table&lt;/strong&gt; structure:&lt;/p&gt;

&lt;pre&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;describe table1;&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Get items&lt;/strong&gt; from table1:&lt;/p&gt;

&lt;pre&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;select * from table1;&lt;/b&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;select name,age from table1;&lt;/b&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;select name,age from table1 where age=25;&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; a &lt;strong&gt;user&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;create user alice@192.168.2.20 identified by 'password2';&lt;/b&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;grant all on db1.* to alice@192.168.2.20;&lt;/b&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;flush privileges;&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Change password&lt;/strong&gt; for alice:&lt;/p&gt;

&lt;pre&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;set password for alice@192.168.2.20 = password('newpassword2');&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Display&lt;/strong&gt; database &lt;strong&gt;users&lt;/strong&gt;:&lt;/p&gt;
&lt;pre&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;select host,name,password from mysql.user;&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Delete user&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;drop user alice@192.168.2.20;&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Display variables&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;show variables like 'port';&lt;/b&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;show variables like 'datadir';&lt;/b&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;show variables where variable_name='port' or variable_name='datadir';&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Exit&lt;/strong&gt; the &lt;strong&gt;CLI&lt;/strong&gt;:&lt;/p&gt;
&lt;pre&gt;
MariaDB[db1]&amp;gt; &lt;b&gt;exit&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Allow port 3306&lt;/strong&gt; in firewalld:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-port=3306/tcp
# firewall-cmd --reload

Or, use a rich rule:
# firewall-cmd --permanent --add-rich-rule 'rule family=ipv4 source address=192.168.2.20 port port=3306 protocol=tcp accept'
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Change listening port&lt;/strong&gt; to &lt;strong&gt;8888/tcp&lt;/strong&gt; and &lt;strong&gt;adjust SELinux context&lt;/strong&gt; on port 8888/tcp:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;semanage port -at -mysqld_port_t 8888 -p tcp&lt;/b&gt;
# &lt;b&gt;vi /etc/my.cnf&lt;/b&gt;
[mysqld]
&lt;b&gt;port=8888&lt;/b&gt;
[...]
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Restart mariadb&lt;/strong&gt;, and &lt;strong&gt;update firewall rules&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart mariadb
# firewall-cmd --permanent --remove-port=3306/tcp
# firewall-cmd --permanent --add-port=8888/tcp
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Change&lt;/strong&gt; mariadb &lt;strong&gt;datadir&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# systemctl stop mariadb
# mkdir /srv/mariadb
# semanage fcontext -at mysqld_db_t &quot;/srv/mariadb(/.*)?&quot;
# restorecon -v /srv/mariadb
# chown mysql: /srv/mariadb
# cp -Rp /var/lib/mysql/* /srv/mariadb/

# &lt;b&gt;vi /etc/my.cnf&lt;/b&gt;
[mysqld]
[...]
&lt;b&gt;#&lt;/b&gt;datadir=/var/lib/mysql
&lt;b&gt;datadir=/srv/mariadb&lt;/b&gt;
[...]
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Check&lt;/strong&gt; owner, &lt;strong&gt;permissions&lt;/strong&gt; and &lt;strong&gt;SELinux contexts&lt;/strong&gt; of the new datadir:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -alZ /srv/mariadb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Start mariadb&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl start mariadb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;MARIADB REMOTE CLIENT&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Install mariadb&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install -y mariadb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Connect&lt;/strong&gt; to a &lt;strong&gt;remote mariadb server&lt;/strong&gt; on &lt;strong&gt;port 8888/tcp&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mysql -ualice -p -hsrv.example.local -P8888
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">server = srv.example.local client = 192.168.2.20/24</summary></entry><entry><title type="html">RHCE - Part7 - ssh</title><link href="http://localhost:4000/rhce/centos7/2020/02/22/rhce-07-ssh.html" rel="alternate" type="text/html" title="RHCE - Part7 - ssh" /><published>2020-02-22T10:10:00-06:00</published><updated>2020-02-22T10:10:00-06:00</updated><id>http://localhost:4000/rhce/centos7/2020/02/22/rhce-07-ssh</id><content type="html" xml:base="http://localhost:4000/rhce/centos7/2020/02/22/rhce-07-ssh.html">&lt;p&gt;server = srv.example.local&lt;br /&gt;
client = 192.168.2.20/24&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;SSHD&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Add SELinux context&lt;/strong&gt; to &lt;strong&gt;allow sshd listening&lt;/strong&gt; on a &lt;strong&gt;non-standard port&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# semanage port -at ssh_port_t 3000 -p tcp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Configure /etc/ssh/sshd_config&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;vi /etc/ssh/sshd_config&lt;/b&gt;
[...]
&lt;b&gt;Listen 22&lt;/b&gt;
&lt;b&gt;Listen 3000&lt;/b&gt;
[...]
&lt;b&gt;PermitRootLogin yes&lt;/b&gt;
[...]
&lt;b&gt;PubkeyAuthentication yes&lt;/b&gt;
[...]
&lt;/pre&gt;

&lt;p&gt;Note: option “PermitRootLogin yes” is NOT RECOMMENDED. Instead, use a user present on both server and client (an ldap user account is the best option).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Add firewall rule&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-port=3000/tcp
# firewall-cmd --reload

Or, a rich-rule:
# firewall-cmd --permanent --add-rich-rule 'rule family=ipv4 source address=192.168.2.20 port port=3000 protocol=tcp accept'
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Restart sshd&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart sshd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;SSH CLIENT&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Create public/private RSA key pair&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;ssh-keygen -t rsa -b 2048&lt;/b&gt;
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): &lt;b&gt;enter&lt;/b&gt;
Enter passphrase (empty for no passphrase): &lt;b&gt;enter&lt;/b&gt;
Enter same passphraase again: &lt;b&gt;enter&lt;/b&gt;
[...]
&lt;/pre&gt;

&lt;p&gt;Use &lt;strong&gt;ssh-copy-id&lt;/strong&gt; to &lt;strong&gt;send&lt;/strong&gt; the &lt;strong&gt;public key&lt;/strong&gt; to the server:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;ssh-copy-id -i ~/.ssh/id_rsa.pub -p 3000 root@srv.example.local&lt;/b&gt;
The authenticity of the host '[srv.example.local]:3000 [...] can't be established.
Are you sure you want to continue connecting (yes/no)? &lt;b&gt;yes&lt;/b&gt;
[...]
root@srv.example.local's password: &lt;b&gt;root_password&lt;/b&gt;
Number of key(s) added: 1
[...]
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Password-less key pair authentication&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ssh -p 3000 root@srv.example.local
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">server = srv.example.local client = 192.168.2.20/24</summary></entry><entry><title type="html">RHCE - Part8 - samba</title><link href="http://localhost:4000/rhce/centos7/2020/02/22/rhce-08-samba.html" rel="alternate" type="text/html" title="RHCE - Part8 - samba" /><published>2020-02-22T10:00:00-06:00</published><updated>2020-02-22T10:00:00-06:00</updated><id>http://localhost:4000/rhce/centos7/2020/02/22/rhce-08-samba</id><content type="html" xml:base="http://localhost:4000/rhce/centos7/2020/02/22/rhce-08-samba.html">&lt;p&gt;server = srv.example.local (192.168.2.10/24)&lt;br /&gt;
client = client.example.local (192.168.2.20/24)&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;SERVER CONFIGURATION&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Install samba&lt;/strong&gt; and &lt;strong&gt;samba-client&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install -y samba samba-client
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; shared &lt;strong&gt;directory&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir /srv/sambashare
# chmod 777 /srv/sambashare
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Set samba_share_t&lt;/strong&gt; SELinux &lt;strong&gt;context&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# semanage fcontext -at samba_share_t &quot;/srv/samba_share(/.*)?&quot;
# restorecon -v /srv/sambashare
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Configure /etc/samba/smb.conf&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[global] section&lt;/strong&gt;:&lt;br /&gt;
By &lt;strong&gt;default&lt;/strong&gt;, &lt;strong&gt;guests&lt;/strong&gt; are &lt;strong&gt;prohibited&lt;/strong&gt; by the following implicit option:  &lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;map to guest = Never&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;If you provide at least one &lt;strong&gt;public share&lt;/strong&gt;, you can &lt;strong&gt;force&lt;/strong&gt; the &lt;strong&gt;guests&lt;/strong&gt; to &lt;strong&gt;use&lt;/strong&gt; the “&lt;strong&gt;nobody&lt;/strong&gt;” &lt;strong&gt;account&lt;/strong&gt; using both of these 2 options: &lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;map to guest = Bad User&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;guest account = nobody&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The &lt;strong&gt;host allow&lt;/strong&gt; option allows networks:&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;host allow = 127. 192.168.2.&lt;/code&gt;&lt;br /&gt;
Or hosts (ip or hostname):&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;host allow = 192.168.2.20 client.example.local&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;vi /etc/samba/smb.conf&lt;/b&gt;
[global]
[...]
hosts allow = 127. 192.168.2.20
[...]

[custom_share]
comment = group share
path = /srv/sambashare
browseable = yes
writable = no
printable = no
valid users = @group, alice
write list = @group
&lt;/pre&gt;

&lt;p&gt;The global configuration only allows the share to be accessed by localhost or 192.168.2.20.&lt;br /&gt;
Every single user requires a user account (ldap is more convenient).&lt;br /&gt;
The share is only writable by the users who belong to the (ldap) group named &lt;code class=&quot;highlighter-rouge&quot;&gt;group&lt;/code&gt; &lt;br /&gt;
The user alice has read access even though she doesn’t belong to the group &lt;code class=&quot;highlighter-rouge&quot;&gt;group&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Check&lt;/strong&gt; samba &lt;strong&gt;configuration&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# testparm -s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Enable&lt;/strong&gt; and &lt;strong&gt;start smb&lt;/strong&gt; and &lt;strong&gt;nmb&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl enable smb smb
# systemctl start smb nmb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Allow&lt;/strong&gt; service in &lt;strong&gt;firewall&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-service=samba
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create user accounts&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# smbpasswd -a alice
# smbpasswd -a user1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note: &lt;code class=&quot;highlighter-rouge&quot;&gt;user1&lt;/code&gt; is a member of &lt;code class=&quot;highlighter-rouge&quot;&gt;group&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CLIENT CONFIGURATION&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;See RHCSA post regarding samba (2nd part):&lt;br /&gt;
&lt;a href=&quot;https://sysadminplayfield.github.io/rhcsa/centos7/2020/02/20/rhcsa-18-nfs-samba.html&quot;&gt;https://sysadminplayfield.github.io/rhcsa/centos7/2020/02/20/rhcsa-18-nfs-samba.html&lt;/a&gt;&lt;/p&gt;</content><author><name></name></author><summary type="html">server = srv.example.local (192.168.2.10/24) client = client.example.local (192.168.2.20/24)</summary></entry><entry><title type="html">RHCSA - Part1 - Reset root password</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-01-reset-root-password.html" rel="alternate" type="text/html" title="RHCSA - Part1 - Reset root password" /><published>2020-02-20T23:00:40-06:00</published><updated>2020-02-20T23:00:40-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-01-reset-root-password</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-01-reset-root-password.html">&lt;p&gt;If the root password is lost, you need to &lt;strong&gt;interrupt&lt;/strong&gt; the &lt;strong&gt;boot process&lt;/strong&gt; and gain access to a &lt;strong&gt;chrooted environment&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
At &lt;strong&gt;grub2&lt;/strong&gt; screen, press “&lt;strong&gt;e&lt;/strong&gt;” to &lt;strong&gt;edit&lt;/strong&gt; the configuration.&lt;br /&gt;
At the end of the line starting with “&lt;strong&gt;linux16&lt;/strong&gt;”, append the following:&lt;/p&gt;

&lt;pre&gt;
&lt;b&gt;[...]&lt;/b&gt;
linux16 /vmlinuz-3.10.0-123.el7.x86_64 root=UUID=[...] ro rd.lvm.lv=centos/swap \  
vconsole.font=latarcyrheb-sun16 rd.lvm.lv=centos/root crashkernel=auto vconsole.keymap=us \  
rhgb quiet LANG=en_US.UTF-8 &lt;b&gt;rd.break enforcing=0&lt;/b&gt;
&lt;b&gt;[...]&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;“&lt;strong&gt;rd.break&lt;/strong&gt;” interrupts the boot process.&lt;br /&gt;
“&lt;strong&gt;enforcing=0&lt;/strong&gt;” sets temporarily SELinux to “Permissive”.&lt;/p&gt;

&lt;p&gt;Proceed with &lt;strong&gt;Ctrl+x&lt;/strong&gt; to continue the boot process with the new configuration.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;Mount&lt;/strong&gt; the &lt;strong&gt;/sysroot&lt;/strong&gt; folder with &lt;strong&gt;read&lt;/strong&gt; and &lt;strong&gt;write&lt;/strong&gt; access, and change root (&lt;strong&gt;chroot&lt;/strong&gt;) to &lt;strong&gt;set&lt;/strong&gt; the &lt;strong&gt;new root password&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
switch_root:/# &lt;b&gt;mount -o rw,remount /sysroot&lt;/b&gt;
switch_root:/# &lt;b&gt;chroot /sysroot&lt;/b&gt;
sh-4.2# &lt;b&gt;passwd&lt;/b&gt;
	Enter new root password:.....
	Confirm new root password:.....
sh-4.2# &lt;b&gt;exit&lt;/b&gt;
switch_root:/# &lt;b&gt;logout&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;
The boot process is finished.&lt;br /&gt;
Log in as root with the new password, and reset the SELinux context of /etc/shadow :&lt;/p&gt;

&lt;pre&gt;
root@localhost# &lt;b&gt;restorecon -v /etc/shadow&lt;/b&gt;
root@localhost# &lt;b&gt;reboot&lt;/b&gt;
&lt;/pre&gt;</content><author><name></name></author><summary type="html">If the root password is lost, you need to interrupt the boot process and gain access to a chrooted environment.</summary></entry></feed>